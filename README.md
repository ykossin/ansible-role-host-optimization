# Ansible Role: Host Optimization

**–†–æ–ª—å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –û–° –∏ —Ö–æ—Å—Ç–∞ –ø–æ–¥ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é (KVM/libvirt)**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Ä–æ–ª–∏)
2. [‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è](#-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–∏ –∏ –∑–∞–¥–∞—á–∏](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–æ–ª–∏-–∏-–∑–∞–¥–∞—á–∏)
4. [–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á](#–¥–µ—Ç–∞–ª—å–Ω–æ–µ-–æ–ø–∏—Å–∞–Ω–∏–µ-–∑–∞–¥–∞—á)
5. [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-—Ä–æ–ª–∏)
6. [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
7. [–†–∏—Å–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#—Ä–∏—Å–∫–∏-–∏-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
8. [–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥](#–ø—Ä–æ–≤–µ—Ä–∫–∞-–∏-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏

–†–æ–ª—å `host-optimization` –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É Linux –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ö–æ—Å—Ç–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏. –û–Ω–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞, –ø–∞–º—è—Ç–∏, —Å–µ—Ç–∏, CPU –∏ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω.

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–æ–ª—å:

- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–º—è—Ç–∏ (swappiness, dirty pages, overcommit, hugepages)
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç IP forwarding –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ (IOMMU, transparent hugepages)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç CPU (governor, frequency scaling)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã (noatime, I/O scheduler)
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è libvirt
- ‚úÖ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç tuned –ø—Ä–æ—Ñ–∏–ª–∏
- ‚úÖ –í—ã–ø–æ–ª–Ω—è–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### üö® –í–ê–ñ–ù–û: –≠—Ç–∞ —Ä–æ–ª—å –≤–Ω–æ—Å–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º—É!

**–†–æ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ (GRUB) - **—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏**
- –§–∞–π–ª `/etc/fstab` - **–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –∑–∞–≥—Ä—É–∑–∫–∏**
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap - **–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏**
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞

**–ü–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:**
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--check` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞
3. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–Ω—É—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Å–∏—Å—Ç–µ–º—ã
4. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ

**–ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ check mode (dry-run)

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–ª–∏ –∏ –∑–∞–¥–∞—á–∏

–†–æ–ª—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥—É–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –∑–∞–¥–∞—á –¥–ª—è –ª—É—á—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏:

```
tasks/
‚îú‚îÄ‚îÄ main.yml           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª - –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ validation.yml     # –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ check.yml          # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ safety-checks.yml  # –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ backup.yml         # –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ packages.yml       # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ memory.yml         # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏
‚îú‚îÄ‚îÄ network.yml        # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏
‚îú‚îÄ‚îÄ cpu.yml            # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CPU
‚îú‚îÄ‚îÄ kernel.yml         # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞
‚îú‚îÄ‚îÄ filesystem.yml     # –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
‚îú‚îÄ‚îÄ limits.yml         # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
‚îú‚îÄ‚îÄ tuned.yml          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ tuned
‚îî‚îÄ‚îÄ verify.yml         # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
```

---

## –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á

### 1. `validation.yml` - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π.

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `host_swappiness` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0-100
- `host_dirty_ratio` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0-100
- `host_dirty_background_ratio` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0-100
- `host_overcommit_memory` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0, 1 –∏–ª–∏ 2
- `host_cpu_governor` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–Ω–æ –∏–∑ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- `host_io_scheduler` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–Ω–æ –∏–∑ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- `host_ulimit_nofile` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 0
- `host_ulimit_nproc` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 0
- `host_hugepages_count` - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ 0

**–†–∏—Å–∫–∏:**
- ‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–º—è—Ç–∏ –º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–æ–π, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `validation`

---

### 2. `check.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–°–æ–±–∏—Ä–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏—Å—Ç–µ–º–µ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π.

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (`uname -m`)
- –¢–∏–ø –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (Intel/AMD) —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É —Ñ–ª–∞–≥–æ–≤ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫—É –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ (vmx –¥–ª—è Intel, svm –¥–ª—è AMD)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∏—Å–∫–∞—Ö –∏ –∏—Ö I/O scheduler

**–†–∏—Å–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- ‚úÖ –ù–µ –∏–∑–º–µ–Ω—è–µ—Ç —Å–∏—Å—Ç–µ–º—É

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ü–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–¢–µ–≥–∏:** `optimization`, `check`

---

### 3. `safety-checks.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–í—ã–ø–æ–ª–Ω—è–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –æ–ø–∞—Å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.

#### 3.1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ–º swap

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –î–æ—Å—Ç—É–ø–Ω—É—é –ø–∞–º—è—Ç—å (–º–∏–Ω–∏–º—É–º 16GB —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ swap (–Ω–µ –±–æ–ª–µ–µ 10% —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ `host_optimization_confirm_dangerous: true`

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô:** –û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö
  - –ó–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ OOM killer
  - –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_swap_disabled: true`
- –ü–µ—Ä–µ–¥ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ–º swap

**–¢–µ–≥–∏:** `optimization`, `safety`, `swap`

#### 3.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º GRUB

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏
  - –ü–æ—Ç–µ—Ä–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`
- –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º GRUB

**–¢–µ–≥–∏:** `optimization`, `safety`, `kernel`

#### 3.3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º fstab

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ noatime –≤ fstab
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ fstab –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
  - –ü–æ—Ç–µ—Ä–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_fstab_noatime: true`
- –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º fstab

**–¢–µ–≥–∏:** `optimization`, `safety`, `filesystem`

#### 3.4. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞–º—è—Ç–∏

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –î–∏–∞–ø–∞–∑–æ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞–º—è—Ç–∏
- –õ–æ–≥–∏—á–µ—Å–∫—É—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å (dirty_background_ratio < dirty_ratio)

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
  - OOM killer –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `safety`, `memory`

---

### 4. `backup.yml` - –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥ –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º.

**–ë—ç–∫–∞–ø–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
- `/etc/default/grub` - –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞
- `/etc/fstab` - –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º noatime
- `/etc/security/limits.conf` - –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –ª–∏–º–∏—Ç–æ–≤

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤:**
```
/root/ansible-backups/host-optimization/
‚îú‚îÄ‚îÄ grub-<timestamp>.bak
‚îú‚îÄ‚îÄ fstab-<timestamp>.bak
‚îî‚îÄ‚îÄ limits-<timestamp>.bak
```

**–†–∏—Å–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ø–∏–π
- ‚úÖ –ù–µ –∏–∑–º–µ–Ω—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**–¢–µ–≥–∏:** `optimization`, `backup`

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞:**
```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ GRUB
cp /root/ansible-backups/host-optimization/grub-<timestamp>.bak /etc/default/grub
update-grub

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ fstab
cp /root/ansible-backups/host-optimization/fstab-<timestamp>.bak /etc/fstab
mount -a
```

---

### 5. `packages.yml` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

**–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã:**
- `cpufrequtils` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç–æ–π CPU
- `tuned` - —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- `sysfsutils` - —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å sysfs

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞ apt
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`

**–¢–µ–≥–∏:** `optimization`, `packages`

---

### 6. `memory.yml` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é —Å–∏—Å—Ç–µ–º—ã.

#### 6.1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ swappiness

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `vm.swappiness` - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å swap.

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** `host_swappiness` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10)

**–ó–Ω–∞—á–µ–Ω–∏—è:**
- `0` - —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è swap
- `10` - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –±–æ–ª—å—à–∏–º RAM
- `60` - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–æ–≤
- `100` - —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å swap

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0-1) –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö
  - –ó–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ OOM killer
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ú–µ–¥–ª–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏–∑-–∑–∞ —á–∞—Å—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è swap
  - –ò–∑–Ω–æ—Å—É SSD –¥–∏—Å–∫–æ–≤

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `memory`

#### 6.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ dirty pages

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø–∏—Å–∏ "–≥—Ä—è–∑–Ω—ã—Ö" —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞–º—è—Ç–∏ –Ω–∞ –¥–∏—Å–∫.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `vm.dirty_ratio` - –ø—Ä–æ—Ü–µ–Ω—Ç –ø–∞–º—è—Ç–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞—á–∏–Ω–∞—é—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∑–∞–ø–∏—Å—å
- `vm.dirty_background_ratio` - –ø—Ä–æ—Ü–µ–Ω—Ç –ø–∞–º—è—Ç–∏, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —Ñ–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞—á–∏–Ω–∞—é—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∑–∞–ø–∏—Å—å

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ü–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å–±–æ–µ –ø–∏—Ç–∞–Ω–∏—è
  - –î–æ–ª–≥–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –Ω–∞ –¥–∏—Å–∫
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –°–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏–∑-–∑–∞ —á–∞—Å—Ç—ã—Ö –∑–∞–ø–∏—Å–µ–π
  - –ò–∑–Ω–æ—Å—É SSD –¥–∏—Å–∫–æ–≤

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `memory`

#### 6.3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ overcommit memory

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫—É overcommit –ø–∞–º—è—Ç–∏ - –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–∏ —Å–∏—Å—Ç–µ–º–∞ –≤—ã–¥–µ–ª—è—Ç—å –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏, —á–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** `host_overcommit_memory` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)

**–ó–Ω–∞—á–µ–Ω–∏—è:**
- `0` - —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `1` - –≤—Å–µ–≥–¥–∞ —Ä–∞–∑—Ä–µ—à–∞—Ç—å overcommit (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏)
- `2` - –Ω–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å overcommit

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ó–Ω–∞—á–µ–Ω–∏–µ `1` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏
  - –ó–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ OOM killer
- ‚ö†Ô∏è –ó–Ω–∞—á–µ–Ω–∏–µ `2` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
  - –û—Ç–∫–∞–∑—É –≤ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `memory`

#### 6.4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hugepages

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ hugepages - –±–æ–ª—å—à–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –ø–∞–º—è—Ç–∏ (–æ–±—ã—á–Ω–æ 2MB) –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `host_hugepages_enabled` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å hugepages
- `host_hugepages_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ hugepages (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1024)

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ—Ö–≤–∞—Ç–∫–µ –æ–±—ã—á–Ω–æ–π –ø–∞–º—è—Ç–∏
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚ö†Ô∏è Hugepages —Ä–µ–∑–µ—Ä–≤–∏—Ä—É—é—Ç –ø–∞–º—è—Ç—å, –æ–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_hugepages_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `memory`, `hugepages`

#### 6.5. –û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–û—Ç–∫–ª—é—á–∞–µ—Ç swap –∏ –∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ fstab.

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** `host_swap_disabled` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: false)

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô:** –û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö
  - –ó–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ OOM killer
  - –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –¢—Ä–µ–±—É–µ—Ç `host_optimization_confirm_dangerous: true`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏ (–º–∏–Ω–∏–º—É–º 16GB)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è swap (–Ω–µ –±–æ–ª–µ–µ 10%)

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_swap_disabled: true`
- –ï—Å–ª–∏ `host_optimization_confirm_dangerous: true`

**–¢–µ–≥–∏:** `optimization`, `memory`, `swap`

---

### 7. `network.yml` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

#### 7.1. IP Forwarding

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–í–∫–ª—é—á–∞–µ—Ç IP forwarding –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–æ–≤ –º–µ–∂–¥—É –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `host_ip_forward_enabled` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å IP forwarding
- `host_ip_forward_ipv4` - –≤–∫–ª—é—á–∏—Ç—å –¥–ª—è IPv4
- `host_ip_forward_ipv6` - –≤–∫–ª—é—á–∏—Ç—å –¥–ª—è IPv6

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –í–∫–ª—é—á–µ–Ω–∏–µ IP forwarding –º–æ–∂–µ—Ç:
  - –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Ñ–∞–π—Ä–≤–æ–ª–∞
  - –ü–æ–∑–≤–æ–ª–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –ø–∞–∫–µ—Ç–æ–≤
  - –¢—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_ip_forward_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `network`

#### 7.2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è TCP

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç TCP –±—É—Ñ–µ—Ä—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `net.core.rmem_max` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –ø—Ä–∏–µ–º–∞
- `net.core.wmem_max` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –ø–µ—Ä–µ–¥–∞—á–∏
- `net.ipv4.tcp_rmem` - —Ä–∞–∑–º–µ—Ä—ã –±—É—Ñ–µ—Ä–æ–≤ –ø—Ä–∏–µ–º–∞ TCP
- `net.ipv4.tcp_wmem` - —Ä–∞–∑–º–µ—Ä—ã –±—É—Ñ–µ—Ä–æ–≤ –ø–µ—Ä–µ–¥–∞—á–∏ TCP
- `net.core.netdev_max_backlog` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—á–µ—Ä–µ–¥—å —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `net.ipv4.tcp_fin_timeout` - —Ç–∞–π–º–∞—É—Ç –∑–∞–∫—Ä—ã—Ç–∏—è TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- `net.ipv4.tcp_keepalive_time` - –∏–Ω—Ç–µ—Ä–≤–∞–ª keepalive –¥–ª—è TCP

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –±—É—Ñ–µ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –£–≤–µ–ª–∏—á–µ–Ω–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ –±—É—Ñ–µ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –°–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏
  - –ü–æ—Ç–µ—Ä–µ –ø–∞–∫–µ—Ç–æ–≤

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `network`

#### 7.3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `net.ipv4.conf.all.send_redirects: 0` - –æ—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- `net.ipv4.conf.default.send_redirects: 0` - –æ—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- `net.ipv4.conf.all.accept_redirects: 0` - –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–µ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- `net.ipv4.conf.default.accept_redirects: 0` - –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–∏–µ–º —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–†–∏—Å–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - —É–ª—É—á—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `network`, `security`

---

### 8. `cpu.yml` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CPU

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã CPU –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

#### 8.1. CPU Governor

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç CPU governor - –∞–ª–≥–æ—Ä–∏—Ç–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç–æ–π CPU.

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** `host_cpu_governor` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "performance")

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- `performance` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –≤—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞)
- `powersave` - —ç–∫–æ–Ω–æ–º–∏—è —ç–Ω–µ—Ä–≥–∏–∏ (–Ω–∏–∑–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞)
- `ondemand` - –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é (–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã)
- `conservative` - –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π (–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã)
- `schedutil` - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —è–¥—Ä–∞ (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º)

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –†–µ–∂–∏–º `performance` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –£–≤–µ–ª–∏—á–µ–Ω–∏—é —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
  - –ü–µ—Ä–µ–≥—Ä–µ–≤—É –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
  - –°–æ–∫—Ä–∞—â–µ–Ω–∏—é —Å—Ä–æ–∫–∞ —Å–ª—É–∂–±—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- ‚ö†Ô∏è –†–µ–∂–∏–º `powersave` –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –°–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - –ó–∞–¥–µ—Ä–∂–∫–∞–º –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_cpu_scaling_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `cpu`

#### 8.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cpufrequtils

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç CPU governor –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `/etc/default/cpufrequtils`.

**–†–∏—Å–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_cpu_scaling_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `cpu`

---

### 9. `kernel.yml` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ Linux —á–µ—Ä–µ–∑ GRUB.

#### 9.1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CPU

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (Intel/AMD) –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π IOMMU.

**–†–∏—Å–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`

**–¢–µ–≥–∏:** `optimization`, `kernel`

#### 9.2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ IOMMU

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–î–æ–±–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã IOMMU –≤ GRUB –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PCI passthrough.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `intel_iommu=on` - –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ Intel
- `amd_iommu=on` - –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ AMD
- `iommu=pt` - —Ä–µ–∂–∏–º pass-through –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏
  - –ü–æ—Ç–µ—Ä–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç —Å–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–π

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`
- –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã IOMMU –≤–∫–ª—é—á–µ–Ω—ã –≤ `host_kernel_params`

**–¢–µ–≥–∏:** `optimization`, `kernel`

#### 9.3. Transparent Hugepages

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–í–∫–ª—é—á–∞–µ—Ç transparent hugepages –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–∞–º—è—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `transparent_hugepage=always` - –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å hugepages
- `transparent_hugepage_defrag=always` - –≤—Å–µ–≥–¥–∞ –¥–µ—Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`
- –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∫–ª—é—á–µ–Ω—ã –≤ `host_kernel_params`

**–¢–µ–≥–∏:** `optimization`, `kernel`

---

### 10. `filesystem.yml` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

#### 10.1. Noatime

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–î–æ–±–∞–≤–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `noatime` –≤ fstab –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º.

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** `host_fstab_noatime` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true)

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ fstab –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∏—Å—Ç–µ–º—ã
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
  - –ü–æ—Ç–µ—Ä–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- ‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–≥—É—Ç –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –≤—Ä–µ–º—è –¥–æ—Å—Ç—É–ø–∞

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_fstab_noatime: true`

**–¢–µ–≥–∏:** `optimization`, `filesystem`

#### 10.2. I/O Scheduler

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç I/O scheduler –¥–ª—è –≤—Å–µ—Ö –¥–∏—Å–∫–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ udev –ø—Ä–∞–≤–∏–ª–∞—Ö.

**–ü–∞—Ä–∞–º–µ—Ç—Ä:** `host_io_scheduler` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "none")

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
- `none` - –¥–ª—è NVMe –¥–∏—Å–∫–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `deadline` - –¥–ª—è SSD –¥–∏—Å–∫–æ–≤
- `noop` - –¥–ª—è SSD –¥–∏—Å–∫–æ–≤
- `cfq` - –¥–ª—è HDD –¥–∏—Å–∫–æ–≤
- `bfq` - –¥–ª—è HDD –¥–∏—Å–∫–æ–≤ (–ª—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- `mq-deadline` - –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Å–∫–æ–≤
- `kyber` - –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Å–∫–æ–≤

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π scheduler –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –°–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–∏—Å–∫–æ–≤
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é I/O
- ‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ scheduler –º–æ–∂–µ—Ç –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_io_scheduler` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

**–¢–µ–≥–∏:** `optimization`, `filesystem`, `io`

---

### 11. `limits.yml` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

#### 11.1. –û–±—â–∏–µ –ª–∏–º–∏—Ç—ã

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ª–∏–º–∏—Ç—ã —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `host_ulimit_nofile` - –ª–∏–º–∏—Ç —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 65536)
- `host_ulimit_nproc` - –ª–∏–º–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 65536)

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ –ª–∏–º–∏—Ç—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –£–≤–µ–ª–∏—á–µ–Ω–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
- ‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–µ –ª–∏–º–∏—Ç—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
  - –û—à–∏–±–∫–∞–º "too many open files"

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `limits`

#### 11.2. –õ–∏–º–∏—Ç—ã –¥–ª—è libvirt

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ libvirt.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `host_libvirt_limits.soft_nofile` - –º—è–≥–∫–∏–π –ª–∏–º–∏—Ç —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
- `host_libvirt_limits.hard_nofile` - –∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
- `host_libvirt_limits.soft_nproc` - –º—è–≥–∫–∏–π –ª–∏–º–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- `host_libvirt_limits.hard_nproc` - –∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- `host_libvirt_limits.soft_memlock` - –º—è–≥–∫–∏–π –ª–∏–º–∏—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
- `host_libvirt_limits.hard_memlock` - –∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é libvirt

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`

**–¢–µ–≥–∏:** `optimization`, `limits`, `libvirt`

---

### 12. `tuned.yml` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ tuned

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å tuned –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `host_tuned_enabled` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å tuned (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: true)
- `host_tuned_profile` - –ø—Ä–æ—Ñ–∏–ª—å tuned (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "virtual-host")

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏:**
- `virtual-host` - –¥–ª—è —Ö–æ—Å—Ç–æ–≤ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `virtual-guest` - –¥–ª—è –≥–æ—Å—Ç–µ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
- `throughput-performance` - –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- `latency-performance` - –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏

**–†–∏—Å–∫–∏:**
- ‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
  - –°–Ω–∏–∂–µ–Ω–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  - –ü—Ä–æ–±–ª–µ–º–∞–º —Å —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º
- ‚ö†Ô∏è Tuned –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏—Å—Ç–µ–º—ã

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ï—Å–ª–∏ `host_optimization_enabled: true`
- –ï—Å–ª–∏ `host_optimization_for_virtualization: true`
- –ï—Å–ª–∏ `host_tuned_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `tuned`

---

### 13. `verify.yml` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—ã–ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- Swappiness
- IP forwarding
- CPU governor
- Hugepages
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞

**–†–∏—Å–∫–∏:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:**
- –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
- –í—Å–µ–≥–¥–∞, –µ—Å–ª–∏ `host_optimization_enabled: true`

**–¢–µ–≥–∏:** `optimization`, `verify`

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```yaml
# –í–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Ö–æ—Å—Ç–∞
host_optimization_enabled: true

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
host_optimization_for_virtualization: true

# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (swap, fstab, grub)
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ true —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ —Ä–∏—Å–∫–∏!
host_optimization_confirm_dangerous: false
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–º—è—Ç–∏

```yaml
# Swappiness (0-100, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1-10 –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤)
host_swappiness: 10

# Dirty ratio (0-100, –ø—Ä–æ—Ü–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏)
host_dirty_ratio: 10

# Dirty background ratio (0-100, –ø—Ä–æ—Ü–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–ø–∏—Å–∏)
host_dirty_background_ratio: 5

# Overcommit memory (0=—ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π, 1=–≤—Å–µ–≥–¥–∞, 2=–Ω–∏–∫–æ–≥–¥–∞)
host_overcommit_memory: 1

# Hugepages
host_hugepages_enabled: false
host_hugepages_count: 1024

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è!)
host_swap_disabled: false
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏

```yaml
# IP forwarding
host_ip_forward_enabled: true
host_ip_forward_ipv4: true
host_ip_forward_ipv6: false
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ CPU

```yaml
# CPU governor (performance, powersave, ondemand, conservative, schedutil)
host_cpu_governor: "performance"

# CPU frequency scaling
host_cpu_scaling_enabled: true
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —è–¥—Ä–∞

```yaml
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
host_kernel_params:
  - name: "iommu"
    value: "pt"
    enabled: true
  - name: "transparent_hugepage"
    value: "always"
    enabled: true
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º

```yaml
# Noatime –≤ fstab
host_fstab_noatime: true

# I/O scheduler (none, deadline, noop, cfq, bfq, mq-deadline, kyber)
host_io_scheduler: "none"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏–º–∏—Ç–æ–≤

```yaml
# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã
host_ulimit_nofile: 65536
host_ulimit_nproc: 65536

# –õ–∏–º–∏—Ç—ã –¥–ª—è libvirt
host_libvirt_limits:
  soft_nofile: 65536
  hard_nofile: 65536
  soft_nproc: 65536
  hard_nproc: 65536
  soft_memlock: "unlimited"
  hard_memlock: "unlimited"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ tuned

```yaml
# Tuned
host_tuned_enabled: true
host_tuned_profile: "virtual-host"
```

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–º. –≤ `defaults/main.yml`.

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π (Check Mode / Dry-Run)

**–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ check mode –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º!**

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
ansible-playbook playbook.yml --check

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
ansible-playbook playbook.yml --check --diff

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤
ansible-playbook playbook.yml --check --tags memory,network
```

### –ë–∞–∑–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

```yaml
- hosts: virtualization_hosts
  become: true
  roles:
    - host-optimization
```

### –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏

```yaml
- hosts: virtualization_hosts
  become: true
  vars:
    host_optimization_for_virtualization: true
    host_ip_forward_enabled: true
    host_swappiness: 1
    host_cpu_governor: "performance"
    host_hugepages_enabled: true
    host_hugepages_count: 4096
    host_fstab_noatime: true
    # ‚ö†Ô∏è –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    host_optimization_confirm_dangerous: true
  roles:
    - host-optimization
```

### –° –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ–º swap (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)

```yaml
- hosts: virtualization_hosts
  become: true
  vars:
    host_swap_disabled: true
    # ‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ true –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è swap!
    host_optimization_confirm_dangerous: true
  roles:
    - host-optimization
```

---

## –†–∏—Å–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞ (GRUB)**
   - ‚ö†Ô∏è –ú–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–π
   - ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
   - ‚úÖ –ó–∞—â–∏—Ç–∞: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ fstab**
   - ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏
   - ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
   - ‚úÖ –ó–∞—â–∏—Ç–∞: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

3. **–û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap**
   - ‚ö†Ô∏è –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏
   - ‚ö†Ô∏è –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
   - ‚úÖ –ó–∞—â–∏—Ç–∞: –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ check mode:**
   ```bash
   ansible-playbook playbook.yml --check --diff
   ```

2. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –¥–æ—Å—Ç—É–ø–µ –∫ –∫–æ–Ω—Å–æ–ª–∏:**
   - –ö–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞
   - IPMI/KVM –¥–æ—Å—Ç—É–ø
   - Rescue —Ä–µ–∂–∏–º

3. **–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é:**
   - –ü–æ–ª–Ω–∞—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–∏—Å—Ç–µ–º—ã
   - –ë—ç–∫–∞–ø—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (—Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

4. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ:**
   - –ù–µ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ —Å—Ä–∞–∑—É –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

5. **–ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –ø–æ—ç—Ç–∞–ø–Ω–æ:**
   - –°–Ω–∞—á–∞–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –ó–∞—Ç–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º

---

## –ü–æ—ç—Ç–∞–ø–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### ‚úÖ –î–∞, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Ö–æ—Å—Ç–∞ —á–∞—Å—Ç—è–º–∏!

–†–æ–ª—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ—ç—Ç–∞–ø–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–≥–æ–≤. –≠—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è:
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç–¥–µ–ª—å–Ω–æ
- –û—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

#### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ)

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
ansible-playbook playbook.yml --tags check,validation --check

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è)
ansible-playbook playbook.yml --tags safety --check

# 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
ansible-playbook playbook.yml --tags backup
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
- –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å
- –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞—é—Ç—Å—è —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

**–†–∏—Å–∫–∏:** ‚úÖ –ù–µ—Ç - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ

---

#### –≠—Ç–∞–ø 2: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
ansible-playbook playbook.yml --tags packages

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ (–±–µ–∑ swap –∏ hugepages)
ansible-playbook playbook.yml --tags memory --skip-tags swap,hugepages

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏
ansible-playbook playbook.yml --tags network,security

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CPU
ansible-playbook playbook.yml --tags cpu

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤
ansible-playbook playbook.yml --tags limits

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
ansible-playbook playbook.yml --tags verify
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è sysctl –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–ø–∞–º—è—Ç—å, —Å–µ—Ç—å)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è CPU governor
- –£–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã

**–†–∏—Å–∫–∏:** ‚úÖ –ù–∏–∑–∫–∏–µ - –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –ª–µ–≥–∫–æ –æ—Ç–∫–∞—Ç–∏—Ç—å

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ä–∞–∑—É
- –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã
- –ù–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

---

#### –≠—Ç–∞–ø 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ)

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω—ã–º–∏!**

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞ (GRUB)
# ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏!
ansible-playbook playbook.yml \
  --tags kernel,backup \
  -e "host_optimization_confirm_dangerous=true"

# –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è - –ü–ï–†–ï–ó–ê–ì–†–£–ó–ò–¢–ï –°–ò–°–¢–ï–ú–£!
sudo reboot

# 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º (fstab)
# ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è!
ansible-playbook playbook.yml \
  --tags filesystem,backup \
  -e "host_optimization_confirm_dangerous=true"

# 3. Hugepages (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã)
ansible-playbook playbook.yml --tags hugepages

# 4. Tuned –ø—Ä–æ—Ñ–∏–ª—å
ansible-playbook playbook.yml --tags tuned

# –ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π - –ü–ï–†–ï–ó–ê–ì–†–£–ó–ò–¢–ï –°–ò–°–¢–ï–ú–£!
sudo reboot
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –ò–∑–º–µ–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ –≤ GRUB
- –ò–∑–º–µ–Ω—è–µ—Ç—Å—è fstab –¥–ª—è noatime
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è I/O scheduler
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è tuned –ø—Ä–æ—Ñ–∏–ª—å

**–†–∏—Å–∫–∏:** ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï - –º–æ–≥—É—Ç —Å–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–π

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ `host_optimization_confirm_dangerous: true`

---

#### –≠—Ç–∞–ø 4: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```bash
# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ swap (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ RAM!)
# ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–ü–ï–†–ê–¶–ò–Ø!
ansible-playbook playbook.yml \
  --tags swap,backup,safety \
  -e "host_swap_disabled=true" \
  -e "host_optimization_confirm_dangerous=true"
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –û—Ç–∫–ª—é—á–∞–µ—Ç—Å—è swap
- –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ swap –≤ fstab

**–†–∏—Å–∫–∏:** ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Ö–≤–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –ú–∏–Ω–∏–º—É–º 16GB RAM (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ swap < 10% (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- ‚úÖ `host_optimization_confirm_dangerous: true`

---

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–µ–≥–æ–≤

#### –¢–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)

```bash
# –í—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
ansible-playbook playbook.yml \
  --tags packages,memory,network,cpu,limits \
  --skip-tags swap,kernel,filesystem,hugepages
```

#### –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
ansible-playbook playbook.yml --tags check,validation,verify --check
```

#### –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```bash
# –¢–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ç—Ä–µ–±—É—é—â–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
ansible-playbook playbook.yml \
  --tags kernel,filesystem \
  -e "host_optimization_confirm_dangerous=true"
```

#### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–≥–æ–≤

```bash
# –í–∞–ª–∏–¥–∞—Ü–∏—è + –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ + –ø—Ä–æ–≤–µ—Ä–∫–∞
ansible-playbook playbook.yml \
  --tags validation,packages,memory,network,cpu,limits,verify

# –í–∞–ª–∏–¥–∞—Ü–∏—è + –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ + —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
ansible-playbook playbook.yml \
  --tags validation,safety,backup
```

#### –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤

```bash
# –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫—Ä–æ–º–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö
ansible-playbook playbook.yml \
  --skip-tags kernel,filesystem,swap

# –ë–µ–∑ tuned –ø—Ä–æ—Ñ–∏–ª—è
ansible-playbook playbook.yml --skip-tags tuned
```

---

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏

–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏ –ø–æ—ç—Ç–∞–ø–Ω–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏:

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞** –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–µ—Ä–≤—ã–º–∏:
   ```bash
   --tags validation,check
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏:
   ```bash
   --tags safety
   ```

3. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤:
   ```bash
   --tags backup
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã** –Ω—É–∂–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è CPU:
   ```bash
   --tags check  # –î–ª—è kernel –º–æ–¥—É–ª—è
   ```

5. **–ü–∞–∫–µ—Ç—ã** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
   ```bash
   --tags packages  # –ü–µ—Ä–µ–¥ cpu, tuned
   ```

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

```bash
# –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
ansible-playbook playbook.yml --tags check,validation,backup

# –®–∞–≥ 2: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)
ansible-playbook playbook.yml \
  --tags packages,memory,network,cpu,limits \
  --skip-tags swap,hugepages

# –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
ansible-playbook playbook.yml --tags verify

# –®–∞–≥ 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω–µ–π
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: free -h, vmstat, iostat, netstat

# –®–∞–≥ 5: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –≤—Å—ë –æ–∫)
ansible-playbook playbook.yml \
  --tags kernel,filesystem \
  -e "host_optimization_confirm_dangerous=true"

# –®–∞–≥ 6: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
sudo reboot

# –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
ansible-playbook playbook.yml --tags verify
cat /proc/cmdline
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –¢–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)

```bash
# –í—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
ansible-playbook playbook.yml \
  --tags validation,check,backup,packages,memory,network,cpu,limits,verify \
  --skip-tags swap,kernel,filesystem,hugepages,tuned
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –∏ —Å–µ—Ç–∏

```bash
# –¢–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –∏ —Å–µ—Ç–∏
ansible-playbook playbook.yml \
  --tags validation,memory,network,verify \
  --skip-tags swap,hugepages
```

---

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –ø—Ä–∏ –ø–æ—ç—Ç–∞–ø–Ω–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏

1. **–í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é:**
   ```bash
   --tags validation
   ```

2. **–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –±—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏:**
   ```bash
   --tags backup
   ```

3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:**
   ```bash
   --tags verify
   ```

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ check mode –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   ```bash
   --check --diff
   ```

5. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:**
   ```bash
   -e "host_optimization_confirm_dangerous=true"
   ```

6. **–ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
   ```bash
   --tags safety
   ```

---

### –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–æ–≤ (—Ä—É—á–Ω–æ–µ)
# –°–º. —Ä–∞–∑–¥–µ–ª "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞" –≤ SECURITY.md

# –û—Ç–∫–ª—é—á–µ–Ω–∏–µ tuned –ø—Ä–æ—Ñ–∏–ª—è
ansible-playbook playbook.yml --tags tuned -e "host_tuned_enabled=false"

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ CPU governor (—Ä—É—á–Ω–æ–µ)
echo "ondemand" > /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ swap (—Ä—É—á–Ω–æ–µ)
swapon -a
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å swap –≤ /etc/fstab
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

```bash
# Swappiness
sysctl vm.swappiness

# IP forwarding
sysctl net.ipv4.ip_forward

# CPU governor
cat /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# Hugepages
cat /proc/meminfo | grep HugePages

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞
cat /proc/cmdline

# –õ–∏–º–∏—Ç—ã
ulimit -a

# I/O scheduler
cat /sys/block/*/queue/scheduler

# Tuned –ø—Ä–æ—Ñ–∏–ª—å
tuned-adm active

# Swap
swapon --show
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:**
   ```bash
   free -h
   vmstat 1 5
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ç–∏:**
   ```bash
   iperf3 -c <server>
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–∏—Å–∫–æ–≤:**
   ```bash
   fio --name=test --ioengine=libaio --iodepth=16 --rw=read --bs=4k --size=1G
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã:**
   ```bash
   journalctl -xe
   dmesg | tail -50
   ```

---

## –¢–µ–≥–∏

- `optimization` - –≤—Å–µ –∑–∞–¥–∞—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- `validation` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- `check` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- `safety` - –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `backup` - —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- `packages` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
- `memory` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏
- `swap` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ swap
- `network` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∏
- `security` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `cpu` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CPU
- `kernel` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞
- `filesystem` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
- `io` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ I/O scheduler
- `limits` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤
- `libvirt` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è libvirt
- `tuned` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ tuned –ø—Ä–æ—Ñ–∏–ª–µ–π
- `verify` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `SECURITY.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `ANALYSIS.md` - –ê–Ω–∞–ª–∏–∑ —Ä–æ–ª–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
- `IMPROVEMENTS.md` - –û–ø–∏—Å–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

ISC License

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** —è–Ω–≤–∞—Ä—å 2026
